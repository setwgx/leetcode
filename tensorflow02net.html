<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2021-05-27</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h2><a id="tensorflow_0"></a>tensorflow入门——构建神经网络</h2>
<p>1.神经元与激活函数</p>
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

<span class="token comment"># 模拟一个 M-P 神经元的工作原理</span>
<span class="token comment"># input_value 是输入值， 类型为一维的tf.constant</span>
<span class="token comment"># weight 是这个神经元的权重， 类型为一维的tf.constant</span>
<span class="token comment"># threshold 是这个神经元的阈值， 类型为零维的tf.constant</span>
<span class="token comment"># 返回值是一个浮点数</span>
<span class="token keyword">def</span> <span class="token function">neuron</span><span class="token punctuation">(</span>input_value<span class="token punctuation">,</span> weight<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 请在此添加代码 完成本关任务</span>
    <span class="token comment"># ********** Begin *********#</span>

    <span class="token comment"># input_value = tf.constant([1., 0.])</span>
    <span class="token comment"># weight =  tf.constant([1., 1.])  </span>
    <span class="token comment"># threshold = tf.constant(2.)</span>
    <span class="token comment"># 神经元接收来自 n 个其他神经元传递过来的输入信号通过权值进行连接 </span>
    y <span class="token operator">=</span> tf<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>input_value<span class="token punctuation">,</span> weight<span class="token punctuation">)</span>
    y <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
    <span class="token comment"># 将连接后的结果与神经元的阈值进行比较</span>
    y <span class="token operator">=</span> tf<span class="token punctuation">.</span>subtract<span class="token punctuation">(</span>y<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span>
    y <span class="token operator">=</span> tf<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
    <span class="token keyword">return</span> y<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># ********** End **********#</span>
    
</code></pre>
<p>2.神经元与激活函数——tanh方法</p>
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

<span class="token comment"># 模拟一个 M-P 神经元</span>
<span class="token keyword">class</span> <span class="token class-name">neuron</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 构造函数</span>
    <span class="token comment"># weight为本神经元的权重，类型为一维的tf.constant</span>
    <span class="token comment"># threshold 是这个神经元的阈值， 类型为零维的tf.constant</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> weight<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 请在此添加代码 完成本关任务</span>
    <span class="token comment"># ********** Begin *********#</span>
        self<span class="token punctuation">.</span>weight <span class="token operator">=</span> weight
        self<span class="token punctuation">.</span>threshold <span class="token operator">=</span> threshold
    <span class="token comment"># ********** End **********#</span>

    <span class="token comment"># 计算函数</span>
    <span class="token comment"># input_value 是输入值， 类型为一维的tf.constant</span>
    <span class="token comment"># 返回值是一个浮点数</span>
    <span class="token keyword">def</span> <span class="token function">computes</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 请在此添加代码 完成本关任务</span>
        <span class="token comment"># ********** Begin *********#</span>
        <span class="token comment"># input_value = tf.constant([1., 0.])</span>
        <span class="token comment"># weight =  tf.constant([1., 1.])  </span>
        <span class="token comment"># threshold = tf.constant(2.)</span>
        <span class="token comment"># 神经元接收来自 n 个其他神经元传递过来的输入信号通过权值进行连接 </span>
        y <span class="token operator">=</span> tf<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>input_value<span class="token punctuation">,</span> self<span class="token punctuation">.</span>weight<span class="token punctuation">)</span>
        y <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        <span class="token comment"># 将连接后的结果与神经元的阈值进行比较</span>
        y <span class="token operator">=</span> tf<span class="token punctuation">.</span>subtract<span class="token punctuation">(</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>threshold<span class="token punctuation">)</span>
        y <span class="token operator">=</span> tf<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>y<span class="token punctuation">)</span>

        <span class="token keyword">return</span> y<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># ********** End **********#</span>
    
</code></pre>
<p>3.构建简单的单隐层前馈神经网络</p>
<pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf

<span class="token comment"># 模拟一个 M-P 神经元</span>
<span class="token keyword">class</span> <span class="token class-name">neuron</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 构造函数</span>
    <span class="token comment"># weight为本神经元的权重，类型为一维的tf.constant</span>
    <span class="token comment"># threshold 是这个神经元的阈值， 类型为零维的tf.constant</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> weight<span class="token punctuation">,</span> threshold<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 请在此添加代码 完成本关任务</span>
        <span class="token comment"># ********** Begin *********#</span>
        self<span class="token punctuation">.</span>weight <span class="token operator">=</span> weight
        self<span class="token punctuation">.</span>threshold <span class="token operator">=</span> threshold

    <span class="token comment"># ********** End **********#</span>

    <span class="token comment"># 计算函数</span>
    <span class="token comment"># input_value 是输入值， 类型为一维的tf.constant</span>
    <span class="token comment"># 返回值是一个浮点数</span>
    <span class="token keyword">def</span> <span class="token function">computes</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 请在此添加代码 完成本关任务</span>
        <span class="token comment"># ********** Begin *********#</span>
        y <span class="token operator">=</span> tf<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>input_value<span class="token punctuation">,</span> self<span class="token punctuation">.</span>weight<span class="token punctuation">)</span>
        y <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        y <span class="token operator">=</span> tf<span class="token punctuation">.</span>subtract<span class="token punctuation">(</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>threshold<span class="token punctuation">)</span>
        y <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        <span class="token keyword">return</span> y<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># ********** End **********#</span>


<span class="token comment"># 模拟神经网络中的一层</span>
<span class="token keyword">class</span> <span class="token class-name">Dense</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 构造函数</span>
    <span class="token comment"># weights 为本层中每个神经元的权重，元素类型为一维的tf.constant，weights的类型是python的列表</span>
    <span class="token comment"># thresholds 为本层中每个神经元的权重，元素类型为零维的tf.constant，thresholds的类型是python的列表</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> weights<span class="token punctuation">,</span> thresholds<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 请在此添加代码 完成本关任务</span>
        <span class="token comment"># ********** Begin *********#</span>
        weights_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>weights<span class="token punctuation">)</span>
        <span class="token comment"># weights_len = tf.size(weights).eval()</span>
        <span class="token comment"># print(weights_len)</span>
        <span class="token comment"># print(weights.shape)</span>
        <span class="token comment"># weights_len = weights.shape[0]</span>
        <span class="token comment"># print(weights_len)</span>
        self<span class="token punctuation">.</span>neurons <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>weights_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>neurons<span class="token punctuation">.</span>append<span class="token punctuation">(</span>neuron<span class="token punctuation">(</span>weights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> thresholds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment"># ********** End **********#</span>

    <span class="token comment"># 计算函数</span>
    <span class="token comment"># input_value 是输入值， 类型为一维的tf.constant</span>
    <span class="token comment"># 返回值应为一个 1 维， 长度为n的Tensor， n是本层中神经元的数量</span>
    <span class="token keyword">def</span> <span class="token function">computes</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 请在此添加代码 完成本关任务</span>
        <span class="token comment"># ********** Begin *********#</span>
        L <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        neurons_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>neurons<span class="token punctuation">)</span>
        <span class="token comment"># neurons_len = tf.size(self.neurons)</span>
        <span class="token comment"># neurons_len = self.neurons.shape[0]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>neurons_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
            L<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>neurons<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>computes<span class="token punctuation">(</span>input_value<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> tf<span class="token punctuation">.</span>constant<span class="token punctuation">(</span>L<span class="token punctuation">)</span>
        <span class="token comment"># ********** End **********#</span>


<span class="token comment"># 模拟一个简单的神经网络</span>
<span class="token comment"># input_value是这个神经网络的输入，类型为一维的tf.constant</span>
<span class="token comment"># wegihtsOfMiddle 是这个神经网络中间层每个神经元的权重， 元素类型为一维的tf.constant，wegihtsOfMiddle的类型是python的列表</span>
<span class="token comment"># thresholdsOfMiddle 是这个神经网络中间层每个神经元的阈值， 元素类型为零维的tf.constant，thresholdsOfMiddle的类型是python的列表</span>
<span class="token comment"># wegihtsOfOut 是这个神经网络输出层每个神经元的权重， 元素类型为一维的tf.constant，wegihtsOfOut 的类型是python的列表</span>
<span class="token comment"># thresholdsOfOut 是这个神经网络输出层每个神经元的阈值， 元素类型为零维的tf.constant，thresholdsOfOut 的类型是python的列表</span>
<span class="token comment"># 返回值是一个一维浮点数组 （注意不是Tensor），数组的长度为输出层神经元的数量</span>
<span class="token keyword">def</span> <span class="token function">NetWork</span><span class="token punctuation">(</span>input_value<span class="token punctuation">,</span> wegihtsOfMiddle<span class="token punctuation">,</span> thresholdsOfMiddle<span class="token punctuation">,</span> weightsOfOut<span class="token punctuation">,</span> thresholdsOfOut<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 请在此添加代码 完成本关任务</span>
    <span class="token comment"># ********** Begin *********#</span>
    middle <span class="token operator">=</span> Dense<span class="token punctuation">(</span>wegihtsOfMiddle<span class="token punctuation">,</span> thresholdsOfMiddle<span class="token punctuation">)</span>
    out <span class="token operator">=</span> Dense<span class="token punctuation">(</span>weightsOfOut<span class="token punctuation">,</span> thresholdsOfOut<span class="token punctuation">)</span>
    <span class="token keyword">return</span> out<span class="token punctuation">.</span>computes<span class="token punctuation">(</span>middle<span class="token punctuation">.</span>computes<span class="token punctuation">(</span>input_value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># ********** End **********#</span>
</code></pre>
</div>
</body>

</html>
